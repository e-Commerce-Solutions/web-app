var w=Object.defineProperty,L=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var p=(s,e,o)=>e in s?w(s,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[e]=o,m=(s,e)=>{for(var o in e||(e={}))D.call(e,o)&&p(s,o,e[o]);if(b)for(var o of b(e))U.call(e,o)&&p(s,o,e[o]);return s},k=(s,e)=>L(s,A(e));import{O as v}from"./bootstrap.esm.25e60e88.js";import{m as M,j as g,o as i,c as n,a as t,t as c,q as x,s as h,v as _,u as S,b as f,F as y,k as I}from"./vendor.91338f32.js";import{_ as C}from"./index.91707331.js";const V={props:{id:String},mounted(){this.id==="add"?Promise.all([this.getAllSKU(),this.draft()]).then(([s,e])=>{console.debug(s,e),this.skuList=s,this.date=this.formatDate(e.date),this.marketplace=e.marketplace,this.items=e.items,this._offcanvas=new v(this.$refs.StockItem),this.disabled=!1,this._offcanvas.show(),this.$refs.StockItem.addEventListener("hidden.bs.offcanvas",this.close)}).catch(console.error):this.get(Number(this.id)).then(s=>{console.debug(s),this.date=this.formatDate(s.date),this.marketplace=s.marketplace,this.items=s.items,this._offcanvas=new v(this.$refs.StockItem),this.disabled=!0,this._offcanvas.show(),this.$refs.StockItem.addEventListener("hidden.bs.offcanvas",this.close)}).catch(console.error)},computed:k(m({},M("Stock",{stockList:"all"})),{skus(){return this.skuList.filter(s=>s.marketplaces.has(this.marketplace))}}),data(){return{_offcanvas:null,disabled:!1,isSaving:!1,isDeleting:!1,date:new Date,marketplace:"",skuList:[],items:[],skuId:"",price:0,amount:1}},methods:m(m({close(){this.$router.replace({name:"stock"})},changeMarketplace(){this.skuId=""},removeItem(s){this.items.splice(s,1)},addItem(){const s=this.skuList.find(e=>e.id===this.skuId);s&&(console.debug(s),this.items.push({skuId:this.skuId,sku:s,price:this.price,amount:this.amount}))},submit(){this.disabled=!0,this.isSaving=!0;const{date:s,marketplace:e,items:o}=this;this.save({date:s,marketplace:e,items:o}).then(()=>{this.disabled=!1,this.isSaving=!1,this._offcanvas.hide()}).catch(console.error)},formatDate(s){let e=new Date(s),o=""+(e.getMonth()+1),r=""+e.getDate(),a=e.getFullYear();return o.length<2&&(o="0"+o),r.length<2&&(r="0"+r),[a,o,r].join("-")}},g("Stock",{draft:"draft",get:"get",save:"save"})),g("SKU",{getAllSKU:"getAll"}))},j={class:"offcanvas offcanvas-end",tabindex:"-1",ref:"StockItem","aria-labelledby":"StockItemLabel"},K={class:"offcanvas-header"},P={class:"offcanvas-title",id:"ProductItemLabel"},N=t("button",{type:"button",class:"btn-close text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1),B={class:"offcanvas-body"},E=["disabled"],F={class:"mb-3"},O=t("label",{for:"dateToAction",class:"form-label"},"Date to Action",-1),T={class:"mb-3"},z=t("label",{for:"marketplace",class:"form-label"},"Marketplace",-1),q=t("option",{value:""},"Open this to select marketplace",-1),G=t("option",{value:"shopee"},"Shopee",-1),Y=t("option",{value:"lazada"},"Lazada",-1),H=[q,G,Y],J={class:"mb-3"},Q=t("label",{class:"form-label"},"Line Items",-1),R={class:"responsive-table"},W={class:"table table-sm table-striped text-center"},X=t("col",null,null,-1),Z=t("col",{width:"100"},null,-1),$=t("col",{width:"100"},null,-1),tt=t("col",{width:"65"},null,-1),et=t("th",null,"#",-1),st=t("th",null,"SKU",-1),ot=t("th",null,"Price",-1),lt=t("th",null,"Amount",-1),at={key:0},it={key:0},nt=["onClick"],dt={key:0},ct={colspan:"2"},rt=t("option",{value:""},"SKU",-1),ut=["value"],ht=t("i",{class:"bi-plus-circle"},null,-1),mt=[ht],ft=t("hr",null,null,-1),_t={key:0,class:"mb-3 text-end"},bt=t("button",{type:"submit",class:"btn btn-primary"},"Publish",-1),pt=[bt];function kt(s,e,o,r,a,d){return i(),n("div",j,[t("div",K,[t("h5",P,c(o.id==="add"?"Add":"")+" Stock Item",1),N]),t("div",B,[t("form",{onSubmit:e[7]||(e[7]=x((...l)=>d.submit&&d.submit(...l),["prevent"]))},[t("fieldset",{disabled:a.disabled},[t("div",F,[O,h(t("input",{type:"date",class:"form-control",id:"dateToAction",placeholder:"Name","onUpdate:modelValue":e[0]||(e[0]=l=>a.date=l)},null,512),[[_,a.date]])]),t("div",T,[z,h(t("select",{class:"form-select",id:"marketplace","onUpdate:modelValue":e[1]||(e[1]=l=>a.marketplace=l),onChange:e[2]||(e[2]=(...l)=>d.changeMarketplace&&d.changeMarketplace(...l))},H,544),[[S,a.marketplace]])]),t("div",J,[Q,t("div",R,[t("table",W,[X,Z,$,tt,t("thead",null,[t("tr",null,[et,st,ot,lt,o.id==="add"?(i(),n("th",at)):f("",!0)])]),t("tbody",null,[(i(!0),n(y,null,I(a.items,(l,u)=>(i(),n("tr",{key:u},[t("td",null,c(u+1),1),t("td",null,c(l.sku.name),1),t("td",null,c(l.price),1),t("td",null,c(l.amount),1),o.id==="add"?(i(),n("td",it,[t("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:vt=>d.removeItem(u)},null,8,nt)])):f("",!0)]))),128))]),o.id==="add"?(i(),n("tfoot",dt,[t("tr",null,[t("td",ct,[h(t("select",{class:"form-select",id:"marketplace","onUpdate:modelValue":e[3]||(e[3]=l=>a.skuId=l)},[rt,(i(!0),n(y,null,I(d.skus,(l,u)=>(i(),n("option",{key:u,value:l.id},c(l.name),9,ut))),128))],512),[[S,a.skuId]])]),t("td",null,[h(t("input",{type:"number",class:"form-control form-control-sm",id:"price",placeholder:"Price","onUpdate:modelValue":e[4]||(e[4]=l=>a.price=l)},null,512),[[_,a.price]])]),t("td",null,[h(t("input",{type:"number",class:"form-control form-control-sm",id:"amount",placeholder:"Amount","onUpdate:modelValue":e[5]||(e[5]=l=>a.amount=l)},null,512),[[_,a.amount]])]),t("td",null,[t("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:e[6]||(e[6]=l=>d.addItem())},mt)])])])):f("",!0)])])]),ft,o.id==="add"?(i(),n("div",_t,pt)):f("",!0)],8,E)],32)])],512)}var wt=C(V,[["render",kt]]);export{wt as default};
